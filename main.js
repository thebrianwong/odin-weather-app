(()=>{"use strict";const e=async e=>{const t=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${e}&appid=a0c9839361f301aa4ff8bb089dde2d79`);return 200===t.status?await t.json():Promise.reject(t)},t=async()=>{const e=Math.floor(508061*Math.random())-1,t=await fetch(`https://wft-geo-db.p.rapidapi.com/v1/geo/cities?limit=1&includeDeleted=NONE&offset=${e}`,{method:"GET",headers:{"X-RapidAPI-Key":"807ea18ec2msh3a2175b27cf041dp170feajsnf745f5536e94","X-RapidAPI-Host":"wft-geo-db.p.rapidapi.com"}});return 200===t.status?await t.json():Promise.reject(t)},r=(()=>{const e=e=>e.main.temp;return{getTemperatureFahrenheit:t=>{const r=9*(e(t)-273.15)/5+32;return Math.round(100*r)/100},getTemperatureCelsius:t=>{const r=e(t)-273.15;return Math.round(100*r)/100},getWeatherMain:e=>e.weather[0].main,getWeatherDescription:e=>e.weather[0].description,getWeatherIconCode:e=>e.weather[0].icon,getCityName:e=>e.name,getRandomCityName:e=>e.data[0].city}})(),o=(()=>{let e=!1;const t=e=>{document.querySelector(".error-message").textContent=e},o=e=>{e.classList.toggle("not-displayed")},a=e=>{document.querySelector(".loading-message").textContent=e},n=e=>new Promise((t=>setTimeout(t,e)));return{updateDisplayedWeather:e=>{(e=>{const t=r.getWeatherIconCode(e);document.querySelector(".weather-icon").src=`http://openweathermap.org/img/wn/${t}@4x.png`})(e),(e=>{const t=r.getWeatherMain(e);document.querySelector(".weather-main").textContent=t})(e),(e=>{const t=r.getWeatherDescription(e);document.querySelector(".weather-description").textContent=t})(e),(e=>{const t=r.getTemperatureFahrenheit(e);document.querySelector(".temp-f").textContent=`${t}째F`})(e),(e=>{const t=r.getTemperatureCelsius(e);document.querySelector(".temp-c").textContent=`${t}째C`})(e),(e=>{const t=r.getCityName(e);document.querySelector(".city-name").textContent=t})(e),document.querySelector("#city").value=""},addPlaceholderValues:()=>{const e=document.querySelector(".weather-icon"),t=document.querySelector(".weather-main"),r=document.querySelector(".weather-description"),o=document.querySelector(".temp-f"),a=document.querySelector(".temp-c"),n=document.querySelector(".city-name");e.src="../dist/mickey.png",t.textContent="The sun might or might not be visible",r.textContent="hopefully the sky is still blue",o.textContent="Larger number째F",a.textContent="Smaller number째C",n.textContent="Disneyland"},changeErrorMessage:t,toggleElementDisplay:o,toggleLoadingInProgress:()=>{const t=document.querySelector("#loading-indicator");Array.from(document.querySelectorAll(".submission-element")).forEach((e=>{!1===e.disabled?e.disabled=!0:e.disabled=!1})),o(t),(async()=>{const t=document.querySelector("#loading-indicator");for(e=!e;e;){if(await n(1e3),Array.from(t.classList).includes("not-displayed")){a("Loading...");break}if(a("Loading."),await n(1e3),Array.from(t.classList).includes("not-displayed")){a("Loading...");break}a("Loading.."),await n(1e3),a("Loading...")}})()},resetError:()=>{const e=document.querySelector(".error-message");Array.from(e.classList).includes("not-displayed")||e.classList.add("not-displayed"),t("")}}})(),a=(()=>{const a=async()=>{const t=document.querySelector("#city").value;if(""!==t)try{const r=await e(t);o.updateDisplayedWeather(r)}catch(e){404===e.status?o.changeErrorMessage("Uh oh, looks like something went wrong! Check your spelling or try a different city!"):429===e.status?o.changeErrorMessage("Whoa, slow down there partner! Save some weather data for the rest of us!"):500===e.status&&o.changeErrorMessage("Something out of our control is broken. Try again later!");const t=document.querySelector(".error-message");o.toggleElementDisplay(t),console.error(Error(e.statusText))}o.toggleLoadingInProgress()},n=async()=>{let a,s;try{const n=await t();a=r.getRandomCityName(n),s=await e(a),o.updateDisplayedWeather(s),o.toggleLoadingInProgress()}catch(e){404===e.status&&void 0===a?o.changeErrorMessage("Hmm, it seems like we're running into some trouble. Try again!"):404===e.status&&void 0===s||429===e.status?setTimeout(n,1500):500===e.status&&o.changeErrorMessage("Something out of our control is broken. Try again later!"),console.error(Error(`${e.status} ${e.statusText}`))}};return{addUserInputListeners:()=>{document.querySelector(".search-button").addEventListener("click",(()=>{o.resetError(),o.toggleLoadingInProgress(),a()})),document.querySelector("#city").addEventListener("keydown",(e=>{"Enter"===e.key&&(o.resetError(),o.toggleLoadingInProgress(),a())})),document.querySelector(".random-button").addEventListener("click",(()=>{o.resetError(),o.toggleLoadingInProgress(),n()})),(()=>{const e=Array.from(document.querySelectorAll(".temp-button"));e.forEach((t=>{t.addEventListener("click",(()=>{e.forEach((e=>{o.toggleElementDisplay(e)}))}))}))})()}}})();!async function(){try{const t=await e("Hell");o.updateDisplayedWeather(t)}catch(e){o.addPlaceholderValues(),console.error(Error(`${e.status} ${e.statusText}. If you can see this, that means there was an issue with the OpenWeatherMap API!`))}}(),a.addUserInputListeners()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SS9DLFNBQVNDLGNBQWMsU0FDL0IwRCxpQkFBaUIsV0FBWUMsSUFDMUIsVUFBZEEsRUFBTUMsTUFFUmpFLEVBQWdCK0MsYUFDZC9DLEVBQWdCc0MsMEJBQ2hCYSxJQUNKLElBSW1CL0MsU0FBU0MsY0FBYyxrQkFDL0IwRCxpQkFBaUIsU0FBUyxLQUVyQy9ELEVBQWdCK0MsYUFDZC9DLEVBQWdCc0MsMEJBQ2hCbUIsR0FBbUIsSUFHYSxNQUNwQyxNQUFNUyxFQUFjMUIsTUFBTUMsS0FBS3JDLFNBQVNzQyxpQkFBaUIsaUJBQ3pEd0IsRUFBWXZCLFNBQVN3QixJQUNuQkEsRUFBT0osaUJBQWlCLFNBQVMsS0FDL0JHLEVBQVl2QixTQUFTd0IsSUFDbkJuRSxFQUFnQk8scUJBQXFCNEQsRUFBTyxHQUM1QyxHQUNGLEdBQ0YsRUFNRkMsRUFBK0IsRUFHbEMsRUF6R2lCLElDQWxCLGlCQUNFLElBQ0UsTUFBTW5HLFFBQWlCSCxFQUEwQixRQUNqRGtDLEVBQWdCZSx1QkFBdUI5QyxFQVF6QyxDQVBFLE1BQU9vRixHQUNQckQsRUFBZ0IrQix1QkFDaEJ1QixRQUFRRCxNQUNORSxNQUNFLEdBQUdGLEVBQU1sRixVQUFVa0YsRUFBTUcsK0ZBRy9CLENBQ0QsQ0FaRCxHQWNBTixFQUFVWSx1QiIsInNvdXJjZXMiOlsid2VicGFjazovL29kaW4td2VhdGhlci1hcHAvLi9zcmMvQVBJX3JlcXVlc3RfbW9kdWxlLmpzIiwid2VicGFjazovL29kaW4td2VhdGhlci1hcHAvLi9zcmMvZmlsdGVyX2RhdGFfbW9kdWxlLmpzIiwid2VicGFjazovL29kaW4td2VhdGhlci1hcHAvLi9zcmMvRE9NX21hbmlwdWxhdGlvbl9tb2R1bGUuanMiLCJ3ZWJwYWNrOi8vb2Rpbi13ZWF0aGVyLWFwcC8uL3NyYy91c2VyX2lucHV0X21vZHVsZS5qcyIsIndlYnBhY2s6Ly9vZGluLXdlYXRoZXItYXBwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IEFQSVJlcXVlc3QgPSAoKCkgPT4ge1xuICBjb25zdCBBUElLRVkgPSBcImEwYzk4MzkzNjFmMzAxYWE0ZmY4YmIwODlkZGUyZDc5XCI7XG4gIGNvbnN0IGdldENpdHlXZWF0aGVyID0gYXN5bmMgKGNpdHkpID0+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgYGh0dHBzOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZy9kYXRhLzIuNS93ZWF0aGVyP3E9JHtjaXR5fSZhcHBpZD0ke0FQSUtFWX1gXG4gICAgKTtcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcbiAgICAgIGNvbnN0IHBhcnNlZE9iamVjdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIHJldHVybiBwYXJzZWRPYmplY3Q7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXNwb25zZSk7XG4gIH07XG4gIGNvbnN0IGdldFJhbmRvbUNpdHkgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgQ0lUWUNPVU5UID0gNTA4MDYxO1xuICAgIGNvbnN0IHJhbmRvbUNpdHlJbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIENJVFlDT1VOVCkgLSAxO1xuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiWC1SYXBpZEFQSS1LZXlcIjogXCI4MDdlYTE4ZWMybXNoM2EyMTc1YjI3Y2YwNDFkcDE3MGZlYWpzbmY3NDVmNTUzNmU5NFwiLFxuICAgICAgICBcIlgtUmFwaWRBUEktSG9zdFwiOiBcIndmdC1nZW8tZGIucC5yYXBpZGFwaS5jb21cIixcbiAgICAgIH0sXG4gICAgfTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgYGh0dHBzOi8vd2Z0LWdlby1kYi5wLnJhcGlkYXBpLmNvbS92MS9nZW8vY2l0aWVzP2xpbWl0PTEmaW5jbHVkZURlbGV0ZWQ9Tk9ORSZvZmZzZXQ9JHtyYW5kb21DaXR5SW5kZXh9YCxcbiAgICAgIG9wdGlvbnNcbiAgICApO1xuICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgY29uc3QgcGFyc2VkT2JqZWN0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgcmV0dXJuIHBhcnNlZE9iamVjdDtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlc3BvbnNlKTtcbiAgfTtcbiAgcmV0dXJuIHsgZ2V0Q2l0eVdlYXRoZXIsIGdldFJhbmRvbUNpdHkgfTtcbn0pKCk7XG5cbmV4cG9ydCB7IEFQSVJlcXVlc3QgfTtcbiIsImNvbnN0IGZpbHRlckRhdGEgPSAoKCkgPT4ge1xuICBjb25zdCBnZXRUZW1wZXJhdHVyZSA9IChkYXRhKSA9PiBkYXRhLm1haW4udGVtcDtcbiAgY29uc3QgZ2V0VGVtcGVyYXR1cmVGYWhyZW5oZWl0ID0gKGRhdGEpID0+IHtcbiAgICBjb25zdCBrZWx2aW4gPSBnZXRUZW1wZXJhdHVyZShkYXRhKTtcbiAgICBjb25zdCBmYWhyZW5oZWl0ID0gKChrZWx2aW4gLSAyNzMuMTUpICogOSkgLyA1ICsgMzI7XG4gICAgcmV0dXJuIE1hdGgucm91bmQoZmFocmVuaGVpdCAqIDEwMCkgLyAxMDA7XG4gIH07XG4gIGNvbnN0IGdldFRlbXBlcmF0dXJlQ2Vsc2l1cyA9IChkYXRhKSA9PiB7XG4gICAgY29uc3Qga2VsdmluID0gZ2V0VGVtcGVyYXR1cmUoZGF0YSk7XG4gICAgY29uc3QgY2Vsc2l1cyA9IGtlbHZpbiAtIDI3My4xNTtcbiAgICByZXR1cm4gTWF0aC5yb3VuZChjZWxzaXVzICogMTAwKSAvIDEwMDtcbiAgfTtcbiAgY29uc3QgZ2V0V2VhdGhlck1haW4gPSAoZGF0YSkgPT4gZGF0YS53ZWF0aGVyWzBdLm1haW47XG4gIGNvbnN0IGdldFdlYXRoZXJEZXNjcmlwdGlvbiA9IChkYXRhKSA9PiBkYXRhLndlYXRoZXJbMF0uZGVzY3JpcHRpb247XG4gIGNvbnN0IGdldFdlYXRoZXJJY29uQ29kZSA9IChkYXRhKSA9PiBkYXRhLndlYXRoZXJbMF0uaWNvbjtcbiAgY29uc3QgZ2V0Q2l0eU5hbWUgPSAoZGF0YSkgPT4gZGF0YS5uYW1lO1xuICBjb25zdCBnZXRSYW5kb21DaXR5TmFtZSA9IChkYXRhKSA9PiBkYXRhLmRhdGFbMF0uY2l0eTtcbiAgcmV0dXJuIHtcbiAgICBnZXRUZW1wZXJhdHVyZUZhaHJlbmhlaXQsXG4gICAgZ2V0VGVtcGVyYXR1cmVDZWxzaXVzLFxuICAgIGdldFdlYXRoZXJNYWluLFxuICAgIGdldFdlYXRoZXJEZXNjcmlwdGlvbixcbiAgICBnZXRXZWF0aGVySWNvbkNvZGUsXG4gICAgZ2V0Q2l0eU5hbWUsXG4gICAgZ2V0UmFuZG9tQ2l0eU5hbWUsXG4gIH07XG59KSgpO1xuXG5leHBvcnQgeyBmaWx0ZXJEYXRhIH07XG4iLCJpbXBvcnQgeyBmaWx0ZXJEYXRhIH0gZnJvbSBcIi4vZmlsdGVyX2RhdGFfbW9kdWxlXCI7XG5cbmNvbnN0IERPTU1hbmlwdWxhdGlvbiA9ICgoKSA9PiB7XG4gIGxldCB0aW1lciA9IGZhbHNlO1xuICBjb25zdCBhZGRXZWF0aGVySWNvbiA9ICh3ZWF0aGVyRGF0YSkgPT4ge1xuICAgIGNvbnN0IHdlYXRoZXJJY29uID0gZmlsdGVyRGF0YS5nZXRXZWF0aGVySWNvbkNvZGUod2VhdGhlckRhdGEpO1xuICAgIGNvbnN0IHdlYXRoZXJJY29uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2VhdGhlci1pY29uXCIpO1xuICAgIHdlYXRoZXJJY29uRWxlbWVudC5zcmMgPSBgaHR0cDovL29wZW53ZWF0aGVybWFwLm9yZy9pbWcvd24vJHt3ZWF0aGVySWNvbn1ANHgucG5nYDtcbiAgfTtcbiAgY29uc3QgYWRkV2VhdGhlck1haW4gPSAod2VhdGhlckRhdGEpID0+IHtcbiAgICBjb25zdCB3ZWF0aGVyTWFpbiA9IGZpbHRlckRhdGEuZ2V0V2VhdGhlck1haW4od2VhdGhlckRhdGEpO1xuICAgIGNvbnN0IHdlYXRoZXJNYWluRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2VhdGhlci1tYWluXCIpO1xuICAgIHdlYXRoZXJNYWluRWxlbWVudC50ZXh0Q29udGVudCA9IHdlYXRoZXJNYWluO1xuICB9O1xuICBjb25zdCBhZGRXZWF0aGVyRGVzY3JpcHRpb24gPSAod2VhdGhlckRhdGEpID0+IHtcbiAgICBjb25zdCB3ZWF0aGVyRGVzY3JpcHRpb24gPSBmaWx0ZXJEYXRhLmdldFdlYXRoZXJEZXNjcmlwdGlvbih3ZWF0aGVyRGF0YSk7XG4gICAgY29uc3Qgd2VhdGhlckRlc2NyaXB0aW9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi53ZWF0aGVyLWRlc2NyaXB0aW9uXCJcbiAgICApO1xuICAgIHdlYXRoZXJEZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSB3ZWF0aGVyRGVzY3JpcHRpb247XG4gIH07XG4gIGNvbnN0IGFkZFRlbXBlcmF0dXJlRmFocmVuaGVpdCA9ICh3ZWF0aGVyRGF0YSkgPT4ge1xuICAgIGNvbnN0IHRlbXBGID0gZmlsdGVyRGF0YS5nZXRUZW1wZXJhdHVyZUZhaHJlbmhlaXQod2VhdGhlckRhdGEpO1xuICAgIGNvbnN0IHRlbXBGRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGVtcC1mXCIpO1xuICAgIHRlbXBGRWxlbWVudC50ZXh0Q29udGVudCA9IGAke3RlbXBGfcKwRmA7XG4gIH07XG4gIGNvbnN0IGFkZFRlbXBlcmF0dXJlQ2Vsc2l1cyA9ICh3ZWF0aGVyRGF0YSkgPT4ge1xuICAgIGNvbnN0IHRlbXBDID0gZmlsdGVyRGF0YS5nZXRUZW1wZXJhdHVyZUNlbHNpdXMod2VhdGhlckRhdGEpO1xuICAgIGNvbnN0IHRlbXBDRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGVtcC1jXCIpO1xuICAgIHRlbXBDRWxlbWVudC50ZXh0Q29udGVudCA9IGAke3RlbXBDfcKwQ2A7XG4gIH07XG4gIGNvbnN0IGFkZENpdHlOYW1lID0gKHdlYXRoZXJEYXRhKSA9PiB7XG4gICAgY29uc3QgY2l0eU5hbWUgPSBmaWx0ZXJEYXRhLmdldENpdHlOYW1lKHdlYXRoZXJEYXRhKTtcbiAgICBjb25zdCBjaXR5TmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNpdHktbmFtZVwiKTtcbiAgICBjaXR5TmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBjaXR5TmFtZTtcbiAgfTtcbiAgY29uc3QgcmVzZXRJbnB1dFZhbHVlID0gKCkgPT4ge1xuICAgIGNvbnN0IGNpdHlJbnB1dEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NpdHlcIik7XG4gICAgY2l0eUlucHV0RWxlbWVudC52YWx1ZSA9IFwiXCI7XG4gIH07XG4gIGNvbnN0IGFkZFBsYWNlaG9sZGVyVmFsdWVzID0gKCkgPT4ge1xuICAgIGNvbnN0IHdlYXRoZXJJY29uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2VhdGhlci1pY29uXCIpO1xuICAgIGNvbnN0IHdlYXRoZXJNYWluRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2VhdGhlci1tYWluXCIpO1xuICAgIGNvbnN0IHdlYXRoZXJEZXNjcmlwdGlvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIud2VhdGhlci1kZXNjcmlwdGlvblwiXG4gICAgKTtcbiAgICBjb25zdCB0ZW1wRkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRlbXAtZlwiKTtcbiAgICBjb25zdCB0ZW1wQ0VsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRlbXAtY1wiKTtcbiAgICBjb25zdCBjaXR5TmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNpdHktbmFtZVwiKTtcbiAgICB3ZWF0aGVySWNvbkVsZW1lbnQuc3JjID0gXCIuLi9kaXN0L21pY2tleS5wbmdcIjtcbiAgICB3ZWF0aGVyTWFpbkVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlRoZSBzdW4gbWlnaHQgb3IgbWlnaHQgbm90IGJlIHZpc2libGVcIjtcbiAgICB3ZWF0aGVyRGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gXCJob3BlZnVsbHkgdGhlIHNreSBpcyBzdGlsbCBibHVlXCI7XG4gICAgdGVtcEZFbGVtZW50LnRleHRDb250ZW50ID0gXCJMYXJnZXIgbnVtYmVywrBGXCI7XG4gICAgdGVtcENFbGVtZW50LnRleHRDb250ZW50ID0gXCJTbWFsbGVyIG51bWJlcsKwQ1wiO1xuICAgIGNpdHlOYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IFwiRGlzbmV5bGFuZFwiO1xuICB9O1xuICBjb25zdCBjaGFuZ2VFcnJvck1lc3NhZ2UgPSAobWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVycm9yLW1lc3NhZ2VcIik7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG4gIH07XG4gIGNvbnN0IHRvZ2dsZVN1Ym1pc3Npb25FbGVtZW50c0VuYWJsZWQgPSAoKSA9PiB7XG4gICAgY29uc3Qgc3VibWlzc2lvbkVsZW1lbnRzID0gQXJyYXkuZnJvbShcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3VibWlzc2lvbi1lbGVtZW50XCIpXG4gICAgKTtcbiAgICBzdWJtaXNzaW9uRWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgaWYgKGVsZW1lbnQuZGlzYWJsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgIGVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuICBjb25zdCB0b2dnbGVFbGVtZW50RGlzcGxheSA9IChlbGVtZW50KSA9PiB7XG4gICAgZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKFwibm90LWRpc3BsYXllZFwiKTtcbiAgfTtcbiAgY29uc3QgY2hhbmdlTG9hZGluZ01lc3NhZ2UgPSAobWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IGxvYWRpbmdNZXNzYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5sb2FkaW5nLW1lc3NhZ2VcIik7XG4gICAgbG9hZGluZ01lc3NhZ2UudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuICB9O1xuICBjb25zdCB3YWl0VGltZXIgPSAoZHVyYXRpb24pID0+XG4gICAgbmV3IFByb21pc2UoKHJlc3BvbnNlKSA9PiBzZXRUaW1lb3V0KHJlc3BvbnNlLCBkdXJhdGlvbikpO1xuICBjb25zdCB0b2dnbGVMb2FkaW5nTWVzc2FnZUN5Y2xlID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGxvYWRpbmdJbmRpY2F0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2xvYWRpbmctaW5kaWNhdG9yXCIpO1xuICAgIHRpbWVyID8gKHRpbWVyID0gZmFsc2UpIDogKHRpbWVyID0gdHJ1ZSk7XG4gICAgd2hpbGUgKHRpbWVyKSB7XG4gICAgICBhd2FpdCB3YWl0VGltZXIoMTAwMCk7XG4gICAgICBpZiAoQXJyYXkuZnJvbShsb2FkaW5nSW5kaWNhdG9yLmNsYXNzTGlzdCkuaW5jbHVkZXMoXCJub3QtZGlzcGxheWVkXCIpKSB7XG4gICAgICAgIGNoYW5nZUxvYWRpbmdNZXNzYWdlKFwiTG9hZGluZy4uLlwiKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjaGFuZ2VMb2FkaW5nTWVzc2FnZShcIkxvYWRpbmcuXCIpO1xuICAgICAgYXdhaXQgd2FpdFRpbWVyKDEwMDApO1xuICAgICAgaWYgKEFycmF5LmZyb20obG9hZGluZ0luZGljYXRvci5jbGFzc0xpc3QpLmluY2x1ZGVzKFwibm90LWRpc3BsYXllZFwiKSkge1xuICAgICAgICBjaGFuZ2VMb2FkaW5nTWVzc2FnZShcIkxvYWRpbmcuLi5cIik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2hhbmdlTG9hZGluZ01lc3NhZ2UoXCJMb2FkaW5nLi5cIik7XG4gICAgICBhd2FpdCB3YWl0VGltZXIoMTAwMCk7XG4gICAgICBjaGFuZ2VMb2FkaW5nTWVzc2FnZShcIkxvYWRpbmcuLi5cIik7XG4gICAgfVxuICB9O1xuICBjb25zdCB0b2dnbGVMb2FkaW5nSW5Qcm9ncmVzcyA9ICgpID0+IHtcbiAgICBjb25zdCBsb2FkaW5nSW5kaWNhdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNsb2FkaW5nLWluZGljYXRvclwiKTtcbiAgICB0b2dnbGVTdWJtaXNzaW9uRWxlbWVudHNFbmFibGVkKCk7XG4gICAgdG9nZ2xlRWxlbWVudERpc3BsYXkobG9hZGluZ0luZGljYXRvcik7XG4gICAgdG9nZ2xlTG9hZGluZ01lc3NhZ2VDeWNsZSgpO1xuICB9O1xuICBjb25zdCByZXNldEVycm9yID0gKCkgPT4ge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVycm9yLW1lc3NhZ2VcIik7XG4gICAgaWYgKCFBcnJheS5mcm9tKGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0KS5pbmNsdWRlcyhcIm5vdC1kaXNwbGF5ZWRcIikpIHtcbiAgICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm5vdC1kaXNwbGF5ZWRcIik7XG4gICAgfVxuICAgIGNoYW5nZUVycm9yTWVzc2FnZShcIlwiKTtcbiAgfTtcbiAgY29uc3QgdXBkYXRlRGlzcGxheWVkV2VhdGhlciA9ICh3ZWF0aGVyRGF0YSkgPT4ge1xuICAgIGFkZFdlYXRoZXJJY29uKHdlYXRoZXJEYXRhKTtcbiAgICBhZGRXZWF0aGVyTWFpbih3ZWF0aGVyRGF0YSk7XG4gICAgYWRkV2VhdGhlckRlc2NyaXB0aW9uKHdlYXRoZXJEYXRhKTtcbiAgICBhZGRUZW1wZXJhdHVyZUZhaHJlbmhlaXQod2VhdGhlckRhdGEpO1xuICAgIGFkZFRlbXBlcmF0dXJlQ2Vsc2l1cyh3ZWF0aGVyRGF0YSk7XG4gICAgYWRkQ2l0eU5hbWUod2VhdGhlckRhdGEpO1xuICAgIHJlc2V0SW5wdXRWYWx1ZSgpO1xuICB9O1xuICByZXR1cm4ge1xuICAgIHVwZGF0ZURpc3BsYXllZFdlYXRoZXIsXG4gICAgYWRkUGxhY2Vob2xkZXJWYWx1ZXMsXG4gICAgY2hhbmdlRXJyb3JNZXNzYWdlLFxuICAgIHRvZ2dsZUVsZW1lbnREaXNwbGF5LFxuICAgIHRvZ2dsZUxvYWRpbmdJblByb2dyZXNzLFxuICAgIHJlc2V0RXJyb3IsXG4gIH07XG59KSgpO1xuXG5leHBvcnQgeyBET01NYW5pcHVsYXRpb24gfTtcbiIsImltcG9ydCB7IEFQSVJlcXVlc3QgfSBmcm9tIFwiLi9BUElfcmVxdWVzdF9tb2R1bGVcIjtcbmltcG9ydCB7IGZpbHRlckRhdGEgfSBmcm9tIFwiLi9maWx0ZXJfZGF0YV9tb2R1bGVcIjtcbmltcG9ydCB7IERPTU1hbmlwdWxhdGlvbiB9IGZyb20gXCIuL0RPTV9tYW5pcHVsYXRpb25fbW9kdWxlXCI7XG5cbmNvbnN0IHVzZXJJbnB1dCA9ICgoKSA9PiB7XG4gIGNvbnN0IHN1Ym1pdFVzZXJJbnB1dCA9IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBjaXR5SW5wdXRWYWx1ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2l0eVwiKS52YWx1ZTtcbiAgICBpZiAoY2l0eUlucHV0VmFsdWUgIT09IFwiXCIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgQVBJUmVxdWVzdC5nZXRDaXR5V2VhdGhlcihjaXR5SW5wdXRWYWx1ZSk7XG4gICAgICAgIERPTU1hbmlwdWxhdGlvbi51cGRhdGVEaXNwbGF5ZWRXZWF0aGVyKHJlc3BvbnNlKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDQwNCkge1xuICAgICAgICAgIC8vIE9wZW5XZWF0aGVyTWFwIEFQSSBjYW4ndCBmaW5kIHRoZSBjaXR5IGR1ZSB0byBtaXNzcGVsbGluZyBvciBsYWNrIG9mIGRhdGFcbiAgICAgICAgICBET01NYW5pcHVsYXRpb24uY2hhbmdlRXJyb3JNZXNzYWdlKFxuICAgICAgICAgICAgXCJVaCBvaCwgbG9va3MgbGlrZSBzb21ldGhpbmcgd2VudCB3cm9uZyEgQ2hlY2sgeW91ciBzcGVsbGluZyBvciB0cnkgYSBkaWZmZXJlbnQgY2l0eSFcIlxuICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MjkpIHtcbiAgICAgICAgICAvLyBPcGVuV2VhdGhlck1hcCBBUEkgcmF0ZSBsaW1pdFxuICAgICAgICAgIERPTU1hbmlwdWxhdGlvbi5jaGFuZ2VFcnJvck1lc3NhZ2UoXG4gICAgICAgICAgICBcIldob2EsIHNsb3cgZG93biB0aGVyZSBwYXJ0bmVyISBTYXZlIHNvbWUgd2VhdGhlciBkYXRhIGZvciB0aGUgcmVzdCBvZiB1cyFcIlxuICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSBpZiAoZXJyb3Iuc3RhdHVzID09PSA1MDApIHtcbiAgICAgICAgICBET01NYW5pcHVsYXRpb24uY2hhbmdlRXJyb3JNZXNzYWdlKFxuICAgICAgICAgICAgXCJTb21ldGhpbmcgb3V0IG9mIG91ciBjb250cm9sIGlzIGJyb2tlbi4gVHJ5IGFnYWluIGxhdGVyIVwiXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lcnJvci1tZXNzYWdlXCIpO1xuICAgICAgICBET01NYW5pcHVsYXRpb24udG9nZ2xlRWxlbWVudERpc3BsYXkoZXJyb3JNZXNzYWdlRWxlbWVudCk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoRXJyb3IoZXJyb3Iuc3RhdHVzVGV4dCkpO1xuICAgICAgfVxuICAgIH1cbiAgICBET01NYW5pcHVsYXRpb24udG9nZ2xlTG9hZGluZ0luUHJvZ3Jlc3MoKTtcbiAgfTtcbiAgY29uc3Qgc3VibWl0UmFuZG9tSW5wdXQgPSBhc3luYyAoKSA9PiB7XG4gICAgbGV0IHJhbmRvbUNpdHlOYW1lO1xuICAgIGxldCB3ZWF0aGVyUmVzcG9uc2U7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNpdHlSZXNwb25zZSA9IGF3YWl0IEFQSVJlcXVlc3QuZ2V0UmFuZG9tQ2l0eSgpO1xuICAgICAgcmFuZG9tQ2l0eU5hbWUgPSBmaWx0ZXJEYXRhLmdldFJhbmRvbUNpdHlOYW1lKGNpdHlSZXNwb25zZSk7XG4gICAgICB3ZWF0aGVyUmVzcG9uc2UgPSBhd2FpdCBBUElSZXF1ZXN0LmdldENpdHlXZWF0aGVyKHJhbmRvbUNpdHlOYW1lKTtcbiAgICAgIERPTU1hbmlwdWxhdGlvbi51cGRhdGVEaXNwbGF5ZWRXZWF0aGVyKHdlYXRoZXJSZXNwb25zZSk7XG4gICAgICBET01NYW5pcHVsYXRpb24udG9nZ2xlTG9hZGluZ0luUHJvZ3Jlc3MoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNDA0ICYmIHJhbmRvbUNpdHlOYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgLy8gR2VvREIgQVBJIGVycm9yXG4gICAgICAgIERPTU1hbmlwdWxhdGlvbi5jaGFuZ2VFcnJvck1lc3NhZ2UoXG4gICAgICAgICAgXCJIbW0sIGl0IHNlZW1zIGxpa2Ugd2UncmUgcnVubmluZyBpbnRvIHNvbWUgdHJvdWJsZS4gVHJ5IGFnYWluIVwiXG4gICAgICAgICk7XG4gICAgICB9IGVsc2UgaWYgKFxuICAgICAgICAoZXJyb3Iuc3RhdHVzID09PSA0MDQgJiYgd2VhdGhlclJlc3BvbnNlID09PSB1bmRlZmluZWQpIHx8XG4gICAgICAgIGVycm9yLnN0YXR1cyA9PT0gNDI5XG4gICAgICApIHtcbiAgICAgICAgLy8gR2VvREIgZ2F2ZSBhIGNpdHkgdGhhdCBoYXMgbm8gZGF0YSBpbiBPcGVuV2VhdGhlck1hcCBBUElcbiAgICAgICAgc2V0VGltZW91dChzdWJtaXRSYW5kb21JbnB1dCwgMTUwMCk7XG4gICAgICB9IGVsc2UgaWYgKGVycm9yLnN0YXR1cyA9PT0gNTAwKSB7XG4gICAgICAgIERPTU1hbmlwdWxhdGlvbi5jaGFuZ2VFcnJvck1lc3NhZ2UoXG4gICAgICAgICAgXCJTb21ldGhpbmcgb3V0IG9mIG91ciBjb250cm9sIGlzIGJyb2tlbi4gVHJ5IGFnYWluIGxhdGVyIVwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBjb25zb2xlLmVycm9yKEVycm9yKGAke2Vycm9yLnN0YXR1c30gJHtlcnJvci5zdGF0dXNUZXh0fWApKTtcbiAgICB9XG4gIH07XG4gIGNvbnN0IGFkZFNlYXJjaEJ1dHRvbkxpc3RlbmVyID0gKCkgPT4ge1xuICAgIGNvbnN0IHNlYXJjaEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VhcmNoLWJ1dHRvblwiKTtcbiAgICBzZWFyY2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIC8vIERPTU1hbmlwdWxhdGlvbi5jaGFuZ2VFcnJvck1lc3NhZ2UoXCJcIiksXG4gICAgICBET01NYW5pcHVsYXRpb24ucmVzZXRFcnJvcigpLFxuICAgICAgICBET01NYW5pcHVsYXRpb24udG9nZ2xlTG9hZGluZ0luUHJvZ3Jlc3MoKSxcbiAgICAgICAgc3VibWl0VXNlcklucHV0KCk7XG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IGFkZElucHV0RWxlbWVudExpc3RlbmVyID0gKCkgPT4ge1xuICAgIGNvbnN0IGNpdHlJbnB1dEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NpdHlcIik7XG4gICAgY2l0eUlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGlmIChldmVudC5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICAvLyBET01NYW5pcHVsYXRpb24uY2hhbmdlRXJyb3JNZXNzYWdlKFwiXCIpLFxuICAgICAgICBET01NYW5pcHVsYXRpb24ucmVzZXRFcnJvcigpLFxuICAgICAgICAgIERPTU1hbmlwdWxhdGlvbi50b2dnbGVMb2FkaW5nSW5Qcm9ncmVzcygpLFxuICAgICAgICAgIHN1Ym1pdFVzZXJJbnB1dCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuICBjb25zdCBhZGRSYW5kb21CdXR0b25MaXN0ZW5lciA9ICgpID0+IHtcbiAgICBjb25zdCByYW5kb21CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJhbmRvbS1idXR0b25cIik7XG4gICAgcmFuZG9tQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAvLyBET01NYW5pcHVsYXRpb24uY2hhbmdlRXJyb3JNZXNzYWdlKFwiXCIpLFxuICAgICAgRE9NTWFuaXB1bGF0aW9uLnJlc2V0RXJyb3IoKSxcbiAgICAgICAgRE9NTWFuaXB1bGF0aW9uLnRvZ2dsZUxvYWRpbmdJblByb2dyZXNzKCksXG4gICAgICAgIHN1Ym1pdFJhbmRvbUlucHV0KCk7XG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IGFkZFRlbXBlcmF0dXJlQnV0dG9uTGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIGNvbnN0IHRlbXBCdXR0b25zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnRlbXAtYnV0dG9uXCIpKTtcbiAgICB0ZW1wQnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IHtcbiAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0ZW1wQnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IHtcbiAgICAgICAgICBET01NYW5pcHVsYXRpb24udG9nZ2xlRWxlbWVudERpc3BsYXkoYnV0dG9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgYWRkVXNlcklucHV0TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIGFkZFNlYXJjaEJ1dHRvbkxpc3RlbmVyKCk7XG4gICAgYWRkSW5wdXRFbGVtZW50TGlzdGVuZXIoKTtcbiAgICBhZGRSYW5kb21CdXR0b25MaXN0ZW5lcigpO1xuICAgIGFkZFRlbXBlcmF0dXJlQnV0dG9uTGlzdGVuZXJzKCk7XG4gIH07XG4gIHJldHVybiB7IGFkZFVzZXJJbnB1dExpc3RlbmVycyB9O1xufSkoKTtcblxuZXhwb3J0IHsgdXNlcklucHV0IH07XG4iLCJpbXBvcnQgeyBBUElSZXF1ZXN0IH0gZnJvbSBcIi4vQVBJX3JlcXVlc3RfbW9kdWxlXCI7XG5pbXBvcnQgeyB1c2VySW5wdXQgfSBmcm9tIFwiLi91c2VyX2lucHV0X21vZHVsZVwiO1xuaW1wb3J0IHsgRE9NTWFuaXB1bGF0aW9uIH0gZnJvbSBcIi4vRE9NX21hbmlwdWxhdGlvbl9tb2R1bGVcIjtcblxuKGFzeW5jIGZ1bmN0aW9uIGluaXRpYWxpemVQYWdlKCkge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgQVBJUmVxdWVzdC5nZXRDaXR5V2VhdGhlcihcIkhlbGxcIik7XG4gICAgRE9NTWFuaXB1bGF0aW9uLnVwZGF0ZURpc3BsYXllZFdlYXRoZXIocmVzcG9uc2UpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIERPTU1hbmlwdWxhdGlvbi5hZGRQbGFjZWhvbGRlclZhbHVlcygpO1xuICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICBFcnJvcihcbiAgICAgICAgYCR7ZXJyb3Iuc3RhdHVzfSAke2Vycm9yLnN0YXR1c1RleHR9LiBJZiB5b3UgY2FuIHNlZSB0aGlzLCB0aGF0IG1lYW5zIHRoZXJlIHdhcyBhbiBpc3N1ZSB3aXRoIHRoZSBPcGVuV2VhdGhlck1hcCBBUEkhYFxuICAgICAgKVxuICAgICk7XG4gIH1cbn0pKCk7XG5cbnVzZXJJbnB1dC5hZGRVc2VySW5wdXRMaXN0ZW5lcnMoKTtcbiJdLCJuYW1lcyI6WyJBUElSZXF1ZXN0IiwiYXN5bmMiLCJjaXR5IiwicmVzcG9uc2UiLCJmZXRjaCIsInN0YXR1cyIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0IiwicmFuZG9tQ2l0eUluZGV4IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwibWV0aG9kIiwiaGVhZGVycyIsImZpbHRlckRhdGEiLCJnZXRUZW1wZXJhdHVyZSIsImRhdGEiLCJtYWluIiwidGVtcCIsImdldFRlbXBlcmF0dXJlRmFocmVuaGVpdCIsImZhaHJlbmhlaXQiLCJyb3VuZCIsImdldFRlbXBlcmF0dXJlQ2Vsc2l1cyIsImNlbHNpdXMiLCJnZXRXZWF0aGVyTWFpbiIsIndlYXRoZXIiLCJnZXRXZWF0aGVyRGVzY3JpcHRpb24iLCJkZXNjcmlwdGlvbiIsImdldFdlYXRoZXJJY29uQ29kZSIsImljb24iLCJnZXRDaXR5TmFtZSIsIm5hbWUiLCJnZXRSYW5kb21DaXR5TmFtZSIsIkRPTU1hbmlwdWxhdGlvbiIsInRpbWVyIiwiY2hhbmdlRXJyb3JNZXNzYWdlIiwibWVzc2FnZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwidG9nZ2xlRWxlbWVudERpc3BsYXkiLCJlbGVtZW50IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiY2hhbmdlTG9hZGluZ01lc3NhZ2UiLCJ3YWl0VGltZXIiLCJkdXJhdGlvbiIsInNldFRpbWVvdXQiLCJ1cGRhdGVEaXNwbGF5ZWRXZWF0aGVyIiwid2VhdGhlckRhdGEiLCJ3ZWF0aGVySWNvbiIsInNyYyIsImFkZFdlYXRoZXJJY29uIiwid2VhdGhlck1haW4iLCJhZGRXZWF0aGVyTWFpbiIsIndlYXRoZXJEZXNjcmlwdGlvbiIsImFkZFdlYXRoZXJEZXNjcmlwdGlvbiIsInRlbXBGIiwiYWRkVGVtcGVyYXR1cmVGYWhyZW5oZWl0IiwidGVtcEMiLCJhZGRUZW1wZXJhdHVyZUNlbHNpdXMiLCJjaXR5TmFtZSIsImFkZENpdHlOYW1lIiwidmFsdWUiLCJhZGRQbGFjZWhvbGRlclZhbHVlcyIsIndlYXRoZXJJY29uRWxlbWVudCIsIndlYXRoZXJNYWluRWxlbWVudCIsIndlYXRoZXJEZXNjcmlwdGlvbkVsZW1lbnQiLCJ0ZW1wRkVsZW1lbnQiLCJ0ZW1wQ0VsZW1lbnQiLCJjaXR5TmFtZUVsZW1lbnQiLCJ0b2dnbGVMb2FkaW5nSW5Qcm9ncmVzcyIsImxvYWRpbmdJbmRpY2F0b3IiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImRpc2FibGVkIiwiaW5jbHVkZXMiLCJ0b2dnbGVMb2FkaW5nTWVzc2FnZUN5Y2xlIiwicmVzZXRFcnJvciIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJhZGQiLCJ1c2VySW5wdXQiLCJzdWJtaXRVc2VySW5wdXQiLCJjaXR5SW5wdXRWYWx1ZSIsImVycm9yIiwiY29uc29sZSIsIkVycm9yIiwic3RhdHVzVGV4dCIsInN1Ym1pdFJhbmRvbUlucHV0IiwicmFuZG9tQ2l0eU5hbWUiLCJ3ZWF0aGVyUmVzcG9uc2UiLCJjaXR5UmVzcG9uc2UiLCJ1bmRlZmluZWQiLCJhZGRVc2VySW5wdXRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJrZXkiLCJ0ZW1wQnV0dG9ucyIsImJ1dHRvbiIsImFkZFRlbXBlcmF0dXJlQnV0dG9uTGlzdGVuZXJzIl0sInNvdXJjZVJvb3QiOiIifQ==